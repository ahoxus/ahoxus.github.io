<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Adding a shopping cart limitation with a warning message</title>
    <link>http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504</link>
    <description>[quote=&quot;cmiller060@gmail.com&quot;]
Hi Caue,

I ran into an issue with the site. Currently we have some products on sale.
Whenever a user has a sale item in their cart, the minimum alert is
triggered even when the user has no wholesale item added.

I commented out the minimum as I need users to continue shopping without
problems. Is this something you can help with. I understand I don&#39;t have
a warranty or maintenance deal on your injection but, if it&#39;s a quick fix
I&#39;d love some help.

thanks
[/quote]
[quote]
forgot the link

http://www.canoegoods.com/shop-wholesale
[/quote]</description>
    <language>en</language>
    <lastBuildDate>Tue, 19 May 2015 12:54:58 +0000</lastBuildDate>
    <category>support</category>
    <atom:link href="http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Adding a shopping cart limitation with a warning message</title>
        <dc:creator><![CDATA[@cregox Caue Rego]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://talk.cregox.com/u/cregox">@cregox</a> wrote:</p>
          <blockquote>
              <p>I'm so glad it worked!</p>

<p>Since then I've been trying to come up with an automated way for testing this out and this is the best cost benefit option I could find so far: <a href="http://www.bugsnag.com">www.bugsnag.com</a></p>

<p>Still back in March I've applied it to my own site now and it is great, but it wouldn't have helped finding bugs such as those last 2 ones you've found, as they were highly unpredictable and, being more of a logic error, they don't really trigger any script error.</p>

<p>In theory, I should generate <em>unit tests</em> trying to picture every scenario possible and you may see the paradox there... They only existed in the first place because they came out of scenarios I haven't pictured!</p>

<p>In any case, just want to let you know I'm still looking for ways to improve this and if I ever find any, I'll make sure to come back and apply 'em to you.</p>
          </blockquote>
          <p><a href="http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504/5">Read full topic</a></p>
        ]]></description>
        <link>http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504/5</link>
        <pubDate>Tue, 19 May 2015 12:54:58 +0000</pubDate>
        <guid isPermaLink="false">talk.cregox.com-post-7504-5</guid>
        <source url="http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504.rss">Adding a shopping cart limitation with a warning message</source>
      </item>
      <item>
        <title>Adding a shopping cart limitation with a warning message</title>
        <dc:creator><![CDATA[@cmiller060 cmiller060]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://talk.cregox.com/u/cmiller060">@cmiller060</a> wrote:</p>
          <blockquote>
              <p>This worked. Thanks. I've, noted your prices changed. I'll let you know when I have more projects in the future!</p>
          </blockquote>
          <p><a href="http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504/4">Read full topic</a></p>
        ]]></description>
        <link>http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504/4</link>
        <pubDate>Thu, 26 Mar 2015 16:59:34 +0000</pubDate>
        <guid isPermaLink="false">talk.cregox.com-post-7504-4</guid>
        <source url="http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504.rss">Adding a shopping cart limitation with a warning message</source>
      </item>
      <item>
        <title>Adding a shopping cart limitation with a warning message</title>
        <dc:creator><![CDATA[@cmiller060 cmiller060]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://talk.cregox.com/u/cmiller060">@cmiller060</a> wrote:</p>
          <blockquote>
              <p>Thanks I'll give this a try.</p>
          </blockquote>
          <p><a href="http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504/3">Read full topic</a></p>
        ]]></description>
        <link>http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504/3</link>
        <pubDate>Thu, 26 Mar 2015 16:53:22 +0000</pubDate>
        <guid isPermaLink="false">talk.cregox.com-post-7504-3</guid>
        <source url="http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504.rss">Adding a shopping cart limitation with a warning message</source>
      </item>
      <item>
        <title>Adding a shopping cart limitation with a warning message</title>
        <dc:creator><![CDATA[@cregox Caue Rego]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://talk.cregox.com/u/cregox">@cregox</a> wrote:</p>
          <blockquote>
              <p>Hey Cameron,</p>

<p>Glad to talk to you again! <img src="//talk-cdn.cregox.com/images/emoji/emoji_one/smile.png?v=0" title=":smile:" class="emoji" alt="smile" width="20" height="20"></p>

<p>A lot have changed since our last contact, such as now I'm using this open and public forum instead of Zendesk, for support tickets. I'm also <a href="https://github.com/cauerego/cregox-scripts">starting to use GitHub</a> for most of the code produced here. And <a href="http://talk.cregox.com/t/the-making-of-your-home/7491/2">prices gone up</a>.</p>

<p>What have not changed, however, is how I do my work in general.</p>

<p>We never talked about sale products indeed, but my script should have worked with them no matter what and I take fault in that. In fact, while digging this up, I found it had a bug unrelated to sale items. If you set the <code>preSelectedItems</code> to anything and didn't add them, it would bring the alert. I'm very ashamed to admit it was all my fault again.</p>

<p>( by the way, that link asks for a password, so I couldn't really test on your end )</p>

<p>So, no matter if it was a quick fix or if it was just what you thought, I feel obligated to fix it. <a href="https://github.com/cauerego/cregox-scripts/commit/4c4e50371b846527028a863e360c598e699a5383">Basically</a>, I just replaced this line:</p>

<pre><code>  if (total &gt; parseFloat(minTotal)) {</code></pre>

<p>for this:</p>

<pre><code>  if (total == 0 || total &gt; parseFloat(minTotal)) {</code></pre>

<p>Now I'll be testing this again see if I find anything else before you do. After all, I've got 2 strikes already! <img src="//talk-cdn.cregox.com/images/emoji/emoji_one/expressionless.png?v=0" title=":expressionless:" class="emoji" alt="expressionless" width="20" height="20"></p>

<p>And <a href="https://github.com/cauerego/cregox-scripts/blob/master/squarespace/limiting%20checkout/limiting-checkout.js">here</a>'s the full code:</p>

<p></p><pre><code class="lang-auto">&lt;script name="limiting checkout" author="cregox.com"&gt;
  // if this list is empty, it will limit checkout for minTotal on the whole subtotal
  // values must be the precise HREF under the item on checkout
  var preSelectedItems = ['/shop/fourty-two', '/shop/ninety-one'];
  
  // if minTotal is 0 or less, there will be no warning
  var minTotal = '200.00';
  
  // customize the message at your will
  var warningMessage = 'For the selected items, you need to add a subtotal of at least $'+ minTotal +' and you only got $%total%';
  
  // code
  $(document).ready(function(){
    var checkout = $('div.checkout .checkout-button');
    checkout.css({'display': 'none'});
    $('&lt;div class="checkout-button"&gt;Checkout&lt;/div&gt;')
     .appendTo(checkout.parent()).click(function(){
      var total = 0;
      if (preSelectedItems &amp;&amp; preSelectedItems.length &gt; 0) {
        $.each(preSelectedItems, function(index, value){
          var addToTotal = $('div.cart-container .item-desc a[href="'+value+'"]').parents('tr').find('span.sqs-money-native').text();
          if ( addToTotal &amp;&amp; !isNaN(parseFloat(addToTotal)) &amp;&amp; isFinite(addToTotal) ) {
            total += parseFloat(addToTotal);
          }
        });
      } else {
        total = parseFloat($('div.subtotal span.sqs-money-native').text());
      }
      if (total == 0 || total &gt; parseFloat(minTotal)) {
        checkout.trigger('click');
      } else {
        var warning = $('&lt;div class="sqs-widgets-confirmation-content clear"&gt;&lt;div class="title"&gt;Unable to Checkout&lt;/div&gt;&lt;div class="message"&gt;'+ warningMessage.replace('%total%', total.toFixed(2)) +'&lt;/div&gt;&lt;div class="buttons"&gt;&lt;div class="confirmation-button no-frame confirm" tabindex="3"&gt;Okay&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;').appendTo(checkout.parent().parent());
        warning.css({'position':'absolute','right':'0px','width':'300px'});
        warning.ready(function(){
          warning.fadeIn('slow');
        });
        warning.find('.confirm').click(function(){
          warning.fadeOut('slow', function(){
            warning.remove();
          });
        });
      }
    });
  });
&lt;/script&gt;</code></pre>
          </blockquote>
          <p><a href="http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504/2">Read full topic</a></p>
        ]]></description>
        <link>http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504/2</link>
        <pubDate>Thu, 26 Mar 2015 16:22:23 +0000</pubDate>
        <guid isPermaLink="false">talk.cregox.com-post-7504-2</guid>
        <source url="http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504.rss">Adding a shopping cart limitation with a warning message</source>
      </item>
      <item>
        <title>Adding a shopping cart limitation with a warning message</title>
        <dc:creator><![CDATA[@system system]]></dc:creator>
        <description><![CDATA[
          <p><a href="http://talk.cregox.com/u/system">@system</a> wrote:</p>
          <blockquote>
              <aside class="quote"><div class="title">
<div class="quote-controls"></div>cmiller060@gmail.com:</div>
<blockquote>
<p>Hi Caue,</p>
<p>I ran into an issue with the site. Currently we have some products on sale.<br>Whenever a user has a sale item in their cart, the minimum alert is<br>triggered even when the user has no wholesale item added.</p>
<p>I commented out the minimum as I need users to continue shopping without<br>problems. Is this something you can help with. I understand I don't have<br>a warranty or maintenance deal on your injection but, if it's a quick fix<br>I'd love some help.</p>
<p>thanks</p>
</blockquote></aside>

<p><aside class="quote"><blockquote>
<p>forgot the link</p>
<p><a href="http://www.canoegoods.com/shop-wholesale" class="onebox" target="_blank">http://www.canoegoods.com/shop-wholesale</a></p>
</blockquote></aside></p>
          </blockquote>
          <p><a href="http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504/1">Read full topic</a></p>
        ]]></description>
        <link>http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504/1</link>
        <pubDate>Thu, 26 Mar 2015 04:25:19 +0000</pubDate>
        <guid isPermaLink="false">talk.cregox.com-post-7504-1</guid>
        <source url="http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504.rss">Adding a shopping cart limitation with a warning message</source>
      </item>
  </channel>
</rss>
