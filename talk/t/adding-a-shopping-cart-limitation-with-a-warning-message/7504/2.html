---
---
<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504/2 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Jun 2017 00:13:26 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Adding a shopping cart limitation with a warning message - support - cregox talk</title>
    <meta name="description" content="">
    <meta name="author" content="">
<meta name="generator" content="Discourse 1.9.0.beta2 - https://github.com/discourse/discourse version c5f42f0e97b27bacd24d07c3180f9b485880e2fc">
<link rel="icon" type="image/png" href="../../../uploads/default/26/774ff9172e02cb85.png">
<link rel="apple-touch-icon" type="image/png" href="../../../images/default-apple-touch-icon.png">
<meta name="theme-color" content="#bbb">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="canonical" href="../7504.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"http://talk.cregox.com","potentialAction":{"@type":"SearchAction","target":"http://talk.cregox.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="cregox talk Search">

        <link href="http://talk-cdn.cregox.com/stylesheets/desktop_8_f58085d5ffeacb0f93c17151285d038856ae1056.css?__ws=talk.cregox.com" media="all" rel="stylesheet" data-target="desktop"/>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4687862-9', {"cookieDomain":"auto"});
</script>

      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Adding a shopping cart limitation with a warning message&#39;" href="../7504.rss" />
  <meta property="og:site_name" content="cregox talk" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://talk-cdn.cregox.com/user_avatar/talk.cregox.com/cregox/200/60_1.png" />
<meta property="og:image" content="https://talk-cdn.cregox.com/user_avatar/talk.cregox.com/cregox/200/60_1.png" />
<meta property="og:url" content="http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504/2" />
<meta name="twitter:url" content="http://talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504/2" />
<meta property="og:title" content="Adding a shopping cart limitation with a warning message" />
<meta name="twitter:title" content="Adding a shopping cart limitation with a warning message" />
<meta property="og:description" content="Hey Cameron,   Glad to talk to you again! smile   A lot have changed since our last contact, such as now I&#39;m using this open and public forum instead of Zendesk, for support tickets. I&#39;m also starting to use GitHub for most of the code produced here. And prices gone up.   What have not changed, however, is how I do my work in general.   We never talked about sale products indeed, but my script should have worked with them no matter what and I take fault in that. In fact, while digging this up, I..." />
<meta name="twitter:description" content="Hey Cameron,   Glad to talk to you again! smile   A lot have changed since our last contact, such as now I&#39;m using this open and public forum instead of Zendesk, for support tickets. I&#39;m also starting to use GitHub for most of the code produced here. And prices gone up.   What have not changed, however, is how I do my work in general.   We never talked about sale products indeed, but my script should have worked with them no matter what and I take fault in that. In fact, while digging this up, I..." />


  </head>
  <body class="crawler">
    <div class="main-nav" style="display:none;">
    <nav class="container">
        <ul class="cf">
            <li><a href="http://cregox.com/"><span>Home</span></a></li>
            <li><a href="http://cregox.com/your-home"><span>Your Home</span></a></li>
            <li><a href="http://cregox.com/about"><span>About / contact</span></a></li>
            <li><a href="../../../c/blog/index.html"><span>Blog</span></a></li>
            <li><a href="http://cregox.com/pay"><span>Pay</span></a></li>
        </ul>
    </nav>
</div>

    <header>
      <a href="../../../index.html"><img src="../../../uploads/default/27/53dfb23e5e9d05d0.png" alt="cregox talk" id="site-logo" style="max-width: 150px;"></a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1>
  <a href="../7504.html">Adding a shopping cart limitation with a warning message</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../../c/support.html" itemprop="url">
        <span itemprop="title">support</span>
      </a>
    </div>
</div>





<hr>


  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/system.html'><b itemprop='author'>system</b></a>
           
           <time datetime='2015-03-26T04:25:19Z' itemprop='datePublished'>
             2015-03-26 04:25:19 UTC
           </time>
        </span>
        <span itemprop='position'>#1</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote"><div class="title">
<div class="quote-controls"></div>cmiller060@gmail.com:</div>
<blockquote>
<p>Hi Caue,</p>
<p>I ran into an issue with the site. Currently we have some products on sale.<br>Whenever a user has a sale item in their cart, the minimum alert is<br>triggered even when the user has no wholesale item added.</p>
<p>I commented out the minimum as I need users to continue shopping without<br>problems. Is this something you can help with. I understand I don't have<br>a warranty or maintenance deal on your injection but, if it's a quick fix<br>I'd love some help.</p>
<p>thanks</p>
</blockquote></aside>

<p><aside class="quote"><blockquote>
<p>forgot the link</p>
<p><a href="http://www.canoegoods.com/shop-wholesale" class="onebox" target="_blank">http://www.canoegoods.com/shop-wholesale</a></p>
</blockquote></aside></p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Adding a shopping cart limitation with a warning message'>
      <hr>
            <a href="../../adding-gift-card-support-on-squarespace-rather-than-coupons/7515/2.html">Adding gift card support on squarespace, rather than coupons</a>
            <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/cregox.html'><b itemprop='author'>cregox</b></a>
           
           <time datetime='2015-03-26T16:22:23Z' itemprop='datePublished'>
             2015-03-26 16:22:23 UTC
           </time>
        </span>
        <span itemprop='position'>#2</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hey Cameron,</p>

<p>Glad to talk to you again! <img src="http://talk-cdn.cregox.com/images/emoji/emoji_one/smile.png?v=0" title=":smile:" class="emoji" alt="smile" width="20" height="20"></p>

<p>A lot have changed since our last contact, such as now I'm using this open and public forum instead of Zendesk, for support tickets. I'm also <a href="https://github.com/cauerego/cregox-scripts">starting to use GitHub</a> for most of the code produced here. And <a href="../../the-making-of-your-home/7491/2.html">prices gone up</a>.</p>

<p>What have not changed, however, is how I do my work in general.</p>

<p>We never talked about sale products indeed, but my script should have worked with them no matter what and I take fault in that. In fact, while digging this up, I found it had a bug unrelated to sale items. If you set the <code>preSelectedItems</code> to anything and didn't add them, it would bring the alert. I'm very ashamed to admit it was all my fault again.</p>

<p>( by the way, that link asks for a password, so I couldn't really test on your end )</p>

<p>So, no matter if it was a quick fix or if it was just what you thought, I feel obligated to fix it. <a href="https://github.com/cauerego/cregox-scripts/commit/4c4e50371b846527028a863e360c598e699a5383">Basically</a>, I just replaced this line:</p>

<pre><code>  if (total &gt; parseFloat(minTotal)) {</code></pre>

<p>for this:</p>

<pre><code>  if (total == 0 || total &gt; parseFloat(minTotal)) {</code></pre>

<p>Now I'll be testing this again see if I find anything else before you do. After all, I've got 2 strikes already! <img src="http://talk-cdn.cregox.com/images/emoji/emoji_one/expressionless.png?v=0" title=":expressionless:" class="emoji" alt="expressionless" width="20" height="20"></p>

<p>And <a href="https://github.com/cauerego/cregox-scripts/blob/master/squarespace/limiting checkout/limiting-checkout.js">here</a>'s the full code:</p>

<p></p><pre><code class="lang-auto">&lt;script name="limiting checkout" author="cregox.com"&gt;
  // if this list is empty, it will limit checkout for minTotal on the whole subtotal
  // values must be the precise HREF under the item on checkout
  var preSelectedItems = ['/shop/fourty-two', '/shop/ninety-one'];
  
  // if minTotal is 0 or less, there will be no warning
  var minTotal = '200.00';
  
  // customize the message at your will
  var warningMessage = 'For the selected items, you need to add a subtotal of at least $'+ minTotal +' and you only got $%total%';
  
  // code
  $(document).ready(function(){
    var checkout = $('div.checkout .checkout-button');
    checkout.css({'display': 'none'});
    $('&lt;div class="checkout-button"&gt;Checkout&lt;/div&gt;')
     .appendTo(checkout.parent()).click(function(){
      var total = 0;
      if (preSelectedItems &amp;&amp; preSelectedItems.length &gt; 0) {
        $.each(preSelectedItems, function(index, value){
          var addToTotal = $('div.cart-container .item-desc a[href="'+value+'"]').parents('tr').find('span.sqs-money-native').text();
          if ( addToTotal &amp;&amp; !isNaN(parseFloat(addToTotal)) &amp;&amp; isFinite(addToTotal) ) {
            total += parseFloat(addToTotal);
          }
        });
      } else {
        total = parseFloat($('div.subtotal span.sqs-money-native').text());
      }
      if (total == 0 || total &gt; parseFloat(minTotal)) {
        checkout.trigger('click');
      } else {
        var warning = $('&lt;div class="sqs-widgets-confirmation-content clear"&gt;&lt;div class="title"&gt;Unable to Checkout&lt;/div&gt;&lt;div class="message"&gt;'+ warningMessage.replace('%total%', total.toFixed(2)) +'&lt;/div&gt;&lt;div class="buttons"&gt;&lt;div class="confirmation-button no-frame confirm" tabindex="3"&gt;Okay&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;').appendTo(checkout.parent().parent());
        warning.css({'position':'absolute','right':'0px','width':'300px'});
        warning.ready(function(){
          warning.fadeIn('slow');
        });
        warning.find('.confirm').click(function(){
          warning.fadeOut('slow', function(){
            warning.remove();
          });
        });
      }
    });
  });
&lt;/script&gt;</code></pre>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Adding a shopping cart limitation with a warning message'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/cmiller060.html'><b itemprop='author'>cmiller060</b></a>
           
           <time datetime='2015-03-26T16:53:22Z' itemprop='datePublished'>
             2015-03-26 16:53:22 UTC
           </time>
        </span>
        <span itemprop='position'>#3</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Thanks I'll give this a try.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Adding a shopping cart limitation with a warning message'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/cmiller060.html'><b itemprop='author'>cmiller060</b></a>
           
           <time datetime='2015-03-26T16:59:34Z' itemprop='datePublished'>
             2015-03-26 16:59:34 UTC
           </time>
        </span>
        <span itemprop='position'>#4</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>This worked. Thanks. I've, noted your prices changed. I'll let you know when I have more projects in the future!</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:1'>
      <meta itemprop='interactionCount' content='UserComments:1'>
      <meta itemprop='headline' content='Adding a shopping cart limitation with a warning message'>
      <hr>
  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <div class='creator'>
        <span>
          <a href='../../../u/cregox.html'><b itemprop='author'>cregox</b></a>
           
           <time datetime='2015-05-19T12:54:58Z' itemprop='datePublished'>
             2015-05-19 12:54:58 UTC
           </time>
        </span>
        <span itemprop='position'>#5</span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I'm so glad it worked!</p>

<p>Since then I've been trying to come up with an automated way for testing this out and this is the best cost benefit option I could find so far: <a href="http://www.bugsnag.com/">www.bugsnag.com</a></p>

<p>Still back in March I've applied it to my own site now and it is great, but it wouldn't have helped finding bugs such as those last 2 ones you've found, as they were highly unpredictable and, being more of a logic error, they don't really trigger any script error.</p>

<p>In theory, I should generate <em>unit tests</em> trying to picture every scenario possible and you may see the paradox there... They only existed in the first place because they came out of scenarios I haven't pictured!</p>

<p>In any case, just want to let you know I'm still looking for ways to improve this and if I ever find any, I'll make sure to come back and apply 'em to you.</p>
      </div>
      <meta itemprop='interactionCount' content='UserLikes:0'>
      <meta itemprop='interactionCount' content='UserComments:0'>
      <meta itemprop='headline' content='Adding a shopping cart limitation with a warning message'>
      <hr>
  </div>






    </div>
    <footer class="container">
      <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <a href='../../../index.html'>Home</a>
        <a href="../../../categories.html">Categories</a>
        <a href="../../../guidelines.html">FAQ/Guidelines</a>
        <a href="../../../tos.html">Terms of Service</a>
        <a href="../../../privacy.html">Privacy Policy</a>
      </nav>
      <p>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  

<!-- Mirrored from talk.cregox.com/t/adding-a-shopping-cart-limitation-with-a-warning-message/7504/2 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Jun 2017 00:13:26 GMT -->
</html>
